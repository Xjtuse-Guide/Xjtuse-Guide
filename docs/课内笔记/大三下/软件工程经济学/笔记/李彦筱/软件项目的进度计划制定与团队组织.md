# 第六章 软件项目的进度计划制订与团队组织

最重要的为第二节：进度计划的分解

## 基本概念与工作流程

生产要素四边形：成本、质量、进度和团队。

这与国际项目管理中更广为人知的“项目管理铁三角”（Iron Triangle），即范围（Scope）、时间（Time）、成本（Cost）以及作为中心目标的“质量”（Quality）模型，异曲同工。

团队：决定软件的生产率和生产因子。

决定进度计划需要：

1. 分解整个计划为多个小的任务
2. 排序每个小任务，根据其依赖关系排序（每个任务需要依赖其他什么任务），得到一个计划任务网

软件项目活动可以分解成层次化的结构，叫做 WBS（软件项目管理的故人）。WBS 可以按照功能，阶段，目标进行分解。

项目活动之间的依赖关系有如下四种：先行、后行、紧前、紧后

1. B 的开始必须在 A 的结束后面进行，那么 B 是 A 的后行活动，A 是 B 的先行活动
2. 如果 A 结束后必须立刻进行 B，那么 B 是 A 的紧后活动，A 是 B 的紧前活动

其实区别就在于是否需要立即执行下一个活动。

计划网络图是**箭线图**（其实项目管理也讲过），即**每个活动是图中的边，而节点只是表示不同状态**。

![IMG_20250526_144317](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBRWibS4-aSYTlgwQ2ry0sWEmKKRp2AAI5GgACnTzhVJHS9mFaYlC0NgQ.jpg)

比如，左侧 a 图中 B 在 A 完成后执行，且两者不是相邻的，因此 B 和 A 之间是后行/先行关系；

b 图中 B 在 A 完成后立刻执行，因此二者是紧后/紧前关系。

### 两种逻辑关系

**刚性逻辑关系**：又称为强制依赖关系，项目工作固有的特性

比如，必须先设计数据库才能开始编写数据库操作代码，必须先写完代码才能写测试，这种不可能更改的、客观存在的依赖关系称为强制依赖关系。

**软逻辑关系**：又称为自由依赖关系，指的是由项目团队定义的制度

比如，团队规定通过飞书进行沟通，一周必须开一次全体大会……这种人为确定的规章制度称为自由依赖关系。

**外部依赖关系**：设计项目活动和非项目活动之间的关系

比如，此项目需要买的深度相机到了才能开展；项目需要一个 ROS 机器人套装才能开展。

### 计划进度网络

这东西在软件项目管理还是重点呢（

箭线图是一个有向图，其边表示项目的活动（任务），每条边的始端和末端分别表示此活动的开始和终止事项。

一个活动需要通过**箭线**+**两个端点**来描述，线上方填写活动编号字母，下方填写活动的耗时。

一个活动想要开始，其前方的所有活动（始端连接的所有输入线对应活动）都必须已经完成。

**箭线图中不能出现环（否则活动会无限循环执行），也不能存在两个起始-终止节点相同的边。**

> 碰到这种边的话，可以将其中一条边分解为两部分，在中间添加一个节点；这两部分当中，一部分可以是空的（耗时为 0），称为虚活动。

![IMG_20250526_145129](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBRmibS5VjBAAB4tUr9ruDUF6Mc7f-XwACOhoAAp084VSJrL_W-AZTnDYE.jpg)

比如 b 中出现了两个开始-结束相同的边，那么需要引入一个新节点 3 拆分其中一个活动，可以拆分为 c 或者 d 图中的形式。

如果软件项目中出现了必要的重复活动，绝对不能使用环，可以把之前的活动复制一份，重复的写在后面。

可以引入虚工序以实现复杂的进度依赖要求：

![IMG_20250526_145639](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBR2ibS5s6VoRmLiY5FXBTTZfv5c9XAAI7GgACnTzhVG3-YteF1jhvNgQ.jpg)

比如下图中，我们希望 b 和 a 部分同步进行，但又希望 a2 完成前 b2 不能开始，此时可以通过添加虚工序 c 实现这一依赖。虚工序不需要执行，仅仅用于表示依赖关系，让 b2 在 c 完成前无法开始，c 在 a2 完成前无法开始，从而实现了我们的要求。

重要特性：封闭性

一个计划网必须只包含**一个起始节点和一个终止节点**。如果存在多个，需要通过虚工序连接或者直接合并等方法，将所有起始节点连接为只有单个起始节点/合并为单个起始节点。

计划网可以通过活动明细表画出。只需要知道每个活动的**紧前活动**即可。绘制方法：

- 寻找没有“紧前活动”的活动作为开始活动
- 寻找所有紧前活动为开始活动的活动，将其作为边添加到图中，其始端为起始活动的末端。
- 同理，寻找所有紧前活动已经在图中的活动，绘制这些活动，直到完成。

对于紧前活动不止一个的活动，先将其绘制到某一个紧前活动的后面，然后通过虚活动和其他所有紧前活动连接就行了。

<mark>**绘制计划图是必考的内容**</mark>。

注意事项：

1. 不要过早的给每个活动添加末端并编号；在找到以某个活动为前置的活动时，再添加编号就行了。

2. 终止活动只能有一个。
3. ✍️✍️✍️虚活动一定要是虚线✍️✍️✍️

### 活动时长的估算

将活动分解为多个子活动之后，每个子活动需要怎么估算呢？有如下几种方法：

1. 经验法：找一堆专家，使用这些专家给出的估算的均值
2. 三点估计法：(最快时间\*1+最可能时间\*4+最长时间*1)/6

## 进度计划的分解

如何通过计划网络图计算出每个任务的开始时间、结束时间和关键路径？

> 这块东西可太像软件项目管理了

时间参数：

TE 和 TL 表示节点的最早开始时间和最晚完成时间。由于节点并不表示活动。没有耗时，因此不存在什么“最早完成时间”和“最晚开始时间”。

每个活动（边）存在四个参数：

- ES：最早开始时间。如果此活动前面的活动都已经完成，那么此活动最早可以什么时候开始？
- LS：最晚开始时间。无论此活动前有多少前置活动，此活动都需要在此时间前开始进行，否则一定导致项目整体进度延迟。
- EF：最早结束时间
- LF：最晚结束时间

![IMG_20250526_153926](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBSGibS6FGk0OVXWc6TPAw_8IQduEmAAI8GgACnTzhVJ3sovefpXMwNgQ.jpg)

ES 和 LS 之间的时间表示此活动开始时间的“容错”，使用 R(i,j)=LS-ES 表示这个时间差。t(i, j) 表示 i 到 j 活动的耗时。

几个时间参数公式的证明：

![IMG_20250526_154455](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBSWibS6gqLO3YK7SGTvYJqcDCKvY2AAI9GgACnTzhVGe0Q4V91nCNNgQ.jpg)

第一个公式表明：开始节点的最早开始时间 = 其活动的最早开始时间。这是很明显的。

第二个公式表示：结束节点的最早开始时间 = 其所有前置活动的“最早结束时间”中最晚的一个。TE(i)+t(i,j)=ES(i,j)+t(i,j)=EF(i,j) 计算出了每个前置任务的最早结束时间（其实就是 EF(i,j)），然后我们取这些最早结束时间中最晚的那个时间。

> 这是因为只要有一个前置活动没有完成，下面的活动就不能开始。

同理，计算开始节点的最晚开始时间时，我们需要寻找其所有后置活动的最晚开始时间中最早的那一个。这就是公式 (4) 的含义。

R(i, j)（机动时间）可以通过 LS-ES 或者 LF-EF 计算，即最晚开始-最早开始或者最晚结束-最早结束都可以。它表示了每个项目可以有多长时间的”容错“而不影响整体进度。

### 关键路线法

关键路线是指计划网中的从开始节点到结束节点的一条路径，需要满足：这条路径在所有开始->结束路径之中是**最长的**。

关键路径的性质：对于关键路径中的任何一个边（活动）(i, j)，其 R(i, j) 一定等于 0，即它没有机动时间。

#### 常见问题

:question:关键路径包括最重要的活动？
:label: NO.关键路径**只与项目的时间维度有关**。“关键”一词并不表明它包含了所有的关键活动

:question:关键路径是项目网络图从头至尾的最短的路径？
**:label: NO.对于项目来说，完成每一项活动都是为了完成项目。它与选择最短的路径没有关系**

:question:一个项目可能有一条以上的关键路径？
:label: **YES.如果项目有两条长度相同的最长路径吗？路径,它就有两条关键路径**

### 求解项目的关键路径

<mark>**此部分也是必考的内容**</mark>。

计算方法：**从前向后计算最早开始/完成时间，从后向前计算最晚开始/完成时间**。

正向计算：根据计划网络图和每个活动的时间，计算每个活动的最早开始时间和最早完成时间。

注意：对于多个活动指向一个活动时，后置活动的最早开始时间**等于所有前置活动最早完成时间中最大的**。

![](https://telegraph-image-5ms.pages.dev/file/AgACAgUAAyEGAASIfjD1AAIBTWibVZn4eDwZ-sl9wgkm2C6uwyb7AAJ2xDEbnTzhVPurOEU1tYXMAQADAgADdwADNgQ.jpg)

> 上方图片用 AI 去掉了老师的头像

完成后，我们可以得到末端节点的最早完成时间。这就是整个工程的工期。接下来，我们从末端利用这个最早完成时间反向计算（将其视为最晚完成时间），得到每个活动的最晚开始时间和最晚完成时间。

注意：对于一个活动指向多个活动时，前置活动的最晚完成时间等于**所有后置活动最晚开始时间中最小的**。

### 计算工期在 x 月内的概率

工期作为一个随机变量服从正态分布，即 $x-N(\mu, \sigma^2)$。其中，均值和方差的计算方法为：

其中 CP 为项目的关键路径：
$$
\mu_{cp}=\sum_{(i,j)\in CP}t(i,j)
$$
即均值等于关键路径上活动耗时的和（假设活动耗时已经通过 $\frac{a_i+4m_i+c_i}{6}$ 计算出了）
$$
\sigma_{cp}^2=\sum_{(i,j)\in CP}(\frac{b_{ij}-a_{ij}}{6})^2
$$
其中 $b_{ij}$ 和 $a_{ij}$ 是**关键路径上** i->j 活动的最长时间和最短时间。<mark>**不是所有工序的**</mark>。

因此，工期在时间 $T_0$ 内完成的概率为：
$$
P(T_d\le T_0)=\Phi(\frac{T_0-\mu_{cp}}{\sigma_{cp}})
$$
其中 $\mu_{cp}$ 和 $\sigma_{cp}$ 分别为分布的均值和标准差。**注意 $\sigma_{cp}$ 不是方差而是标准差**。$\Phi$ 是正态分布的标准分布函数，查表就行或者考试中会给。

如果项目有多条关键路径该怎么办呢？

由于关键路径的长度必须一致，因此两条路径的**均值一定相等**。但二者的**方差不一定相等**。（P202）事实上，方差大的关键路径在某一工期前的完成概率小于方差小的关键路径。因此，只需要保证方差大的关键路径能够按时完成，另一条关键路径就不会有问题了。

### 难度系数

难度系数是一个用于评估项目完成概率的风险指标。

对于关键路径长度为 $\mu_{cp}$，方差为 $\sigma_{cp}^2$ 的项目，假设要求其在 $T_0$ 时间内完成，那么其难度系数为：
$$
\delta_0=2\times\frac{T_0-\mu_{cp}}{\sigma_{cp}}
$$
仍然注意分母是标准差而非方差。

难度系数对应的完成概率如下：

![image-20250528082823733](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBS2ibS7AtS4AzOV8dOegYTzYDU3xPAAI_GgACnTzhVDXStBFEoD6gNgQ.png)
