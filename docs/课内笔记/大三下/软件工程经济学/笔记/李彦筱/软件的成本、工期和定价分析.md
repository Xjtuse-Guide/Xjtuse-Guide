# 第三章 软件的成本、工期和定价分析

## 软件的成本构成与影响因素分析

成本的概念：p69

成本的五个特点：p69

成本的分类：p70。软件行业的**研发成本**和**生产成本**最高。

为什么固定成本叫短期成本？一是因为一次投入就不用再一直投入了，二是因为很难在短时间内改变投入量。

软件成本的定义：p71

软件成本影响因素：p73：

成本的主要因素包含三点：**设备**，**工期**和人力资源投入量。

成本测算一定有误差，只要误差在 20% 内就算成功。

## 软件成本与工期的测算方法

### 功能分解法

功能分解法的基本思想为首先从结构上将软件成本按功能/性能和生存周期阶段两个维度进行分解，若设系统的生存周期为 n 个阶段，软件按功能/性能分为m 个子系统，采用矩阵表示：

$N_{ij}$ 表示第 i 个子系统在第 j 个生存周期下的成本。需要估计成本费用率（一行代码值多少钱），劳动生产率（一天产生多少代码）和工时费用率（每个月的工时）

实际估计方法：

1. 代码行数估计：估计每个模块的最少代码数量，最多代码数量和最可能代码数量，根据 1:1:4 的比例计算出本模块的平均代码数量 Ej。

2. 估计元/行：即估计每个模块单行代码的价格，直接估计就行了。通过单位价格 Cij * 平均代码行数 Ej，可以得到每个模块的预估价格 Cj

   这个单位价格可能和每个模块实现的难度有关。

3. 工期估计：估计每个模块每人每月的平均产出代码行数，然后可以计算出假设此模块只有一个人完成，需要多长时间（Mj），单位称为“人月”。这个时间估计包含了软件生命周期的所有阶段。事实上，很可能在前两个月的可行性分析、需求分析和概要设计中，程序员一行代码也没有写；在第三个月的编码中，直接完成了整个模块。

将所有模块的预估价格加起来就是总价格。题目在 p77-78，先忽略表 3.5

**这种总体预估方法只需要添加三列**：

- 一个模块平均代码行数 = (最大+最小+4最可能) / 6
- 一个模块总成本=平均行数 \* 单行成本
- 一个模块总时间（=平均代码行数 / 生产率）

然后，我们把每个模块的工时分配到软件周期的四个阶段（需求分析，设计，编码和测试），再列出一个表：

> 注意每个阶段工时的和不需要严格等于之前估计的总工期，但理论上应当趋于一致。

![image-20250428152627017](https://telegraph-image-5ms.pages.dev/file/BQACAgUAAyEGAASIfjD1AAIBOmibRifvDHibycudsyd7FIBOEM-2AAIoGgACnTzhVGWFtKhZOXiTNgQ.png)

> 每行的和（每个模块在四个阶段的工时和）需要等于之前估算出的每个模块工时。
>
> 按列相加，可以得到每个阶段所有模块的工时总和。
>
> 每个阶段的平均工资（元/人月）是直接估计的，不是计算出的
>
> 总成本根据每个阶段的人/月时间乘此阶段的平均工资得到。

不过，上面的总成本和工时只包含软件的四个生命周期，不包含系统维护和运行的成本。为了得到真正的总成本和工时，我们可以将上方的成本和工时乘一个固定系数，一般为 1.4，以得到软件全生命周期的总成本。

### Delphi 法

p80

上面我们自己预估，计算了软件的工时和成本。不过，如果我们请了很多专家来预估软件的工时和成本呢？如何平衡各个专家的不同意见呢？可以采用 Delphi 方法。 

求解流程：p80 上面的流程图。该方法在软件项目管理中也有应用：

- 专家独立的估计软件的成本
- 组委会计算专家估计值的均值，方差和变异系数
- 如果方差小于某个阈值，那么结束；否则，将均值，方差和变异系数公布给专家组，再次发出调查表，让他们根据总结果，再次独立估计软件的成本（回到第一步）

### 统计模型法

p82

统计模型法主要采用回归分析建立模型（和机器学习的线性回归非常相似）。我们选择一些条件（硬件投入，工作量，工期，系统功能）作为自变量，成本作为因变量 y，选择某个函数 y=f(x1, x2, ..., xn) 然后做回归模型的训练。

常见的模型看书（y=ax+b 线性，y=ax^b^，1/y=a+b/x，y=ae^bx^，y=a+b lnx，y=k/(1+be^ax^)。

### 影响因子法

p85

在统计模型的基础上通过引入更多的对y有影响的要素来完成对统计模型估计值的修正的一种定性与定量相结合的方法。

影响因子取值方法：因子等级评分法（p86），根据不同等级定性，然后每个等级对应一种分数即可。

### COCOMO 模型

p87 页有公式（定义），这个看书抄就可以了。

三个步骤：

1. 根据软件是“嵌入型“，“组织型”或者“半独立型”，查询 P88 的表 3.10 得到 r, k, h, d 四个参数

2. 根据每个影响因素的评级，查 3.11 表得到每个影响的数字 Ui

3. 计算：先通过 $M_o=rL^k$ 计算初始工作量（L 为规模，以 kDSL 为单位，32kDSL 的话 L=32）

   然后计算所有影响因子的数字乘积 U

   之后套公式完成计算：

   工作量 Ms = U\* Mo

   时间 Td = h(Ms)^d^

   成本 C = $\alpha\times M_s$，其中 a 题目肯定会给，是工时费用（元/人月）

### 表格法和类比法

类比法：p94 下方，计算几个参数即可，权重固定取 w1=0.4, w2=0.3, w3=0.3。

### 设备折旧的计算

p95 页下方

1. 直线折旧法：假设每年设备损失的价值相等

   设 A。表示一年设备的折旧额，k。表示设备的原始价值，O 表 示设备若干年后的残值 (预计)，T 表示设备的最终使用年限，a 表示设备的年基本折旧率
   $$
   A_b=\frac{k_0-O}{T}
   $$

   $$
   a=\frac{A_b}{k_0}=\frac{k_0-O}{T\times k_0}
   $$

   第二个折旧率就是把每年损失的折旧值除以原始价值，得到一个比率。

2. 加速折旧法：

   设备在整个使用过程中，其效能是变化的， 其中使用的前几年，设备处于良好状态，效能较高，因而可为企业提供较高的效益，而在使用后期，由于设备的各种有形磨损(如摩擦、振动、介质腐蚀、材料老化等导致)与无形磨损(如由于技术进步而不断出现新的高性能、低价格的设备，而使原设备价值降低导致)加速

   因此，应当在前面的年份分摊更多的价值流失量。**折旧公式采用等差数列**：

   比如，一共使用五年，那么折旧比例分别为 5,4,3,2,1，因此每年消耗的价值分别为 5/15, 4/15, 3/15, 2/15, 1/15，乘一下 Ab 就可以了。

   > 只要设计的折旧数列是单调递减的即可，即前几年的折旧价值高于后几年。


## 软件成本与价值工程分析

价值工程分析：分析你对软件的研发投入和重要程度是否是匹配的。

符号：

1. C：成本，前面已经存在无数分析软件成本的方法
2. V：价值，即对于一个产品具有的功能 F 来说，其成本 C 是否合算。我们计算 V=F/C。

价值工程分析的目的：提高产品的价值（提高 F/C 的比值）

### 价值系数法

是一种判断价值是否匹配成本的方法

CI：成本系数；FI：功能系数；VI：价值系数。其中：

$CI_j=\dfrac{C_j}{\sum_{j=1}^m c_j}$，即第 j 部分的成本系数 = 此部分成本 / 总成本

$FI_j$ 需要通过此部分功能/全部功能得出，一般采用比较矩阵法/层次分析法得到 FI 占所有功能的比例。
$$
VI_j=\dfrac{FI_j}{CI_j}
$$
这个公式和价值的定义一样。

判断方法：

VI=1，说明价值和成本相匹配；VI>1，说明此模块比想象中更加重要，需要投入更多的成本；VI<1，说明此模块成本过高，应当减少投入。

### ABC 分类法

又称为帕累托分类法，用于找到软件中几个最重要的组件。方法如下：

1. 将各个模块的成本从大到小排序，然后计算每个模块的成本系数
2. 寻找三个分类点：从前向后（按照成本系数从大到小）累加成本系数。当成本系数首次大于 0.7 时，计当前已经累加的所有模块为 A 类；成本系数首次大于 0.9 时，将已经累加不属于 A 类的模块计为 B 类；剩余模块属于 C 类

即 A 类模块就是成本最大的几个模块，且这些模块的成本系数和大于 0.7。通常 A 类模块的数量不应当超过模块总数的 20%。

### 挣值管理和成本控制

挣值管理（EVM）是项目管理中的一种重要技术，用于客观地衡量项目绩效和进展。

总预算成本 TBC：完成一个项目总共需要多少成本

累计预算成本 CBC：在某个时间，预计此前需要花费多少成本

累计实际成本 CAC：在某个时间，实际已经花费了多少成本

累计实现价值 CEV：净值，在某个时间为止，实际已经创造了多少价值。

计算方法：每个模块已完成的代码行数 \* 每行代码的平均价钱 之和

几个偏差指标：

成本偏差 CV= CEV - CAC，即实际创造的价值 - 实际花费的成本，表示**当前产出的价值和投入成本的差异**，大于 0 表示项目目前是赚钱的，小于 0 表示项目目前正在赔钱

成本绩效：CPI = CEV/CAC，即投入单位成本，得到了多少价值。

进度偏差 SV = CEV - CBC，即当前时刻产出的价值和预期产出价值的偏差。正：项目进度提前；负：项目进度落后。

SPI: CEV/CBC，当前产出价值和预期产出价值的比例。

FCAC：项目完工时实际需要花费的成本，两种预计方法：

1. 不变方法：TBC / CPI，表示按照当前的成本开销水平，项目完工时实际需要花费的成本
2. 最乐观方法：CAC + (TBC - CEV)，即项目剩余部分完全按照预算完成时，实际花费的总成本

## 软件产品的定价与营销

定价的依据（目标）：

1. 利润导向目标（最大化利润）
2. 收益导向目标（尽快回本）
3. 销售导向目标
4. 品牌导向目标
5. 维持生存目标

感受价值定价法：推出一个新产品时采用，根据此市场消费者期待的平均价格定价。
