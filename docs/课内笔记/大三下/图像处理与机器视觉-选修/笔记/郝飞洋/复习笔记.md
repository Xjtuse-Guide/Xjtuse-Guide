本来是想做一个复习笔记的，但是复习到一半开始生病，到考试都没复习完，所以就考完目前先补充了一些考试情况信息，其他的最近也不太有空再写了。有多少传多少吧，大家见谅。

# 导论

![Pasted image 20250606225002](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250606225002.png)

# 数字图像处理基础

## 图像感知与获取

### 人类视觉系统

人类视觉系统

视网膜、虹膜、中央凹

椎体细胞、杆体细胞

### 相机系统

传感器

## 取样和量化

把连续的数据数字化：（2025 填空 下面两个加粗的是空，第一道，令人有点摸不着头脑）
取样：空间**坐标**数字化 样本数影响取样质量
量化：图像**函数值**数字化 灰度级影响量化质量（灰度级不足可能导致伪轮廓）

图像与灰度直方图的对应关系是：
A.一对一
B.多对一（应该是选这个吧，
C.一对多
D.不确定

灰度图像中值越大越白，越小越黑。

动态范围：灰度跨越的范围（图像中的最大可度灰度和最小可检测灰度之比）
可度量灰度上限取决于饱和度，下限取决于噪声。
对比度：图像中最高和最低灰度级间的灰度差。

空间分辨率：图像中可辨别的最小细节的度量。
灰度分辨率：在灰度级中可分辨的最小变化。

### 图像内插（重取样）

最近邻插值、线性插值（两个参考点）、双线性插值（四个参考点）、双三次插值（16 个最近邻点）

![Pasted image 20250606230322](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250606230322.png)

## 像素间的基本关系

### 邻域、邻接、连通

对于一个像素：
4 邻域：上下左右
8 邻域：上下左右+四角

对于一对像素：
4 邻接、8 邻接
m 邻接（混合邻接）：用于消除边缘检测中 8 邻接的二义性。

详细讲一下 m 邻接：
如果在边缘检测中使用 4 邻接，那么斜对角连一条线就把这个算法难住了，因为他们确实 4 邻接不了一点。但是如果用 8 邻接呢，对于直角的情况，既可以把边缘画成一个直角，又可以把边缘直接画成一条斜线，这样就会产生二义性。（就如同文法有二义性的时候就需要人为定义算符的优先级或者悬挂else的归属问题，）我们规定，如果旁边已经有一个兄弟能用四邻接把你俩连通起来了，你俩就没必要再寒酸地 8 连通了。
官方的定义：
如果（满足条件之一即可）：

 - q在 $N_4(p)$ 中
 - q在 $N_d(p)$ 中（也就是对角线上的四个像素）且集合 $N_4(p) \cap N_4(q)$ 中没有来自 $V$ 中数值的像素
   则具有V中数值的两个像素p和q是m邻接的。

通路：邻接的像素构成的路线，有 4 通路、8 通路。
连通、连通分量、连通集（只有一个连通分量的像素集）
区域：一个像素子集，且构成了连通集。
邻接区域：两个区域联合形成一个连通集。

### 前景与背景

一幅图像包含 $K$ 个不连接的区域 $R_k, k=1,2,...$ 且都**不接触图像的边界**。
前景：所有区域的并集
背景：前景的补集

边界：前景中邻域（需要指定是什么邻域4,8,m）内有背景的像素集合。

### 距离度量（2025 选择）

（注意区分棋盘和街区，都是方格，当时脑子一烧（物理意义）就选错了）

欧氏距离：就是日常用的直线距离，形成一个圆平面
D4距离（城市街区距离，曼哈顿距离）：只能走横或者竖，形成一个菱形（距离为 1 的像素形成 4 邻域）
D8距离（棋盘距离）：横坐标差和纵坐标差取 max，形成一个正方形（距离为 1 的像素形成 8 邻域）
Dm 距离：两点间的最短 m 通路的长度。（距离为 1 的像素形成 m 邻域）

# 灰度变换和空间滤波

## 空间域与变换域

空间域：图像平面本身，直接以图像中的像素操作为基础
变换域：变换系数处理，不直接对图像像素进行处理

邻域：图像中任意一点(x,y)的邻域是包含该点的小区域。一般是矩形。也称为掩模(mask)、核(kernel)、模板(template)、窗口(window)。

## 简单的灰度变换函数：线性、对数、幂次

反转图像（黑白乾坤大反转）：
$$
s = (L-1) - r
$$
对数变换（低灰度值范围拉宽，高灰度值进行压缩）：
$$
s = c\log(1+r)
$$

幂律（伽马）变换：
$$
s = cr ^{\gamma}
$$
![Pasted image 20250607104259](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250607104259.png)


## 直方图处理

### 直方图

图像的直方图和初中学的概率统计直方图没有什么区别，归一化之后表示的是某个灰度在图像中出现的频率（概率估计）。
$$
p(r_k) = n_k / MN
$$
$r_k$ ：某个灰度级的像素个数，$M$：图像像素的行数，$N$ ：图像像素的列数

暗图小数多，亮图大数多，对比度弱集中，对比度强分散

### 直方图均衡化

#### 原理

直方图可以看成是一个图像灰度级的概率分布函数，直方图均衡化要做的事情就是把这个分布函数做变换，变换的目标是一个均匀分布。

现在要做的就是求这个变换函数，设为
$$
s = T(r), r \in [0, L-1]
$$
输入原图中的某个灰度值 $r$，经过变换就可以得到新的灰度值 $s$。

想一下这个变换需要具有什么性质？

- （严格）单调递增：像素之间明暗的相对关系不能反转
- 定义域和值域都必须是在 $[0, L-1]$

复习一下概率论的概率密度变换的公式：
$$
p_s(s) = p_r(r) |\frac{dr}{ds}|
$$

现在想让变换后的分布是一个均匀分布，也就是
$$
p_s(s) = \frac{1}{(L-1)}
$$

下面是简单的等式的基本性质应用题：
$$
(L-1)p_r(r) =|\frac{ds}{dr}| = |\frac{dT(r)}{dr}|
$$

这里仿佛没有涉及到负数，绝对值就先去掉了：
$$
dT(r) = (L-1) p_r(r) dr
$$

下面是简单的等式两边同时积分环节：
$$
T(r) = (L-1) \int_0^r p_r(w) dw
$$

好了大功告成。

这是概率密度变换，但是图像是离散的，那就把积分换成离散的求和：
$$
s_k = T(r_k) = (L-1) \sum_{j=0}^{k} p_r(r_j) = \frac{(L-1)}{MN}\sum_{j=0}^{k} n_j, k = 0, 1, 2, ..., L-1
$$

这就是直方图均衡化的公式。

下面来做一道例题：

#### 例题

**例题：** 假设一幅大小为 64×64，像素 $MN=4096$ 的3比特图像 $L=8$ 的灰度分布如下表所示，其中灰度级是范围 $[0, L-1]=[0, 7]$中的整数。

| $r_k$   | $n_k$ | $p_r(r_k)=n_k/MN$ |
| ------- | ----- | ----------------- |
| $r_0=0$ | 790   | 0.19              |
| $r_1=1$ | 1023  | 0.25              |
| $r_2=2$ | 850   | 0.21              |
| $r_3=3$ | 656   | 0.16              |
| $r_4=4$ | 329   | 0.08              |
| $r_5=5$ | 245   | 0.06              |
| $r_6=6$ | 122   | 0.03              |
| $r_7=7$ | 81    | 0.02              |

- $r_k$：灰度级（0-7）
- $n_k$：对应灰度级的像素数量
- $p_r(r_k)$：对应灰度级的概率分布，计算公式为 $n_k/MN$
- 总像素数：$MN = 64 \times 64 = 4096$

**解：**

$s_0 = T(r_0) = 7\sum_{j=0}^{0} p_r(r_j) = 7p_r(r_0) = 1.33$

$s_1 = T(r_1) = 7\sum_{j=0}^{1} p_r(r_j) = 7p_r(r_0) + 7p_r(r_1) = 3.08$

$s_2 = 4.55, \quad s_3 = 5.67, \quad s_4 = 6.23, \quad s_5 = 6.65, \quad s_6 = 6.86, \quad s_7 = 7.00$

该变换函数的形状为阶梯状（看清这个图的细节画法，2025 考试要求从零画出来）：

![Pasted image 20250607162408](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250607162408.png)

灰度值不能是小数，所以需要**四舍五入**一下：

| 原始值     | 舍入后 | 原始值     | 舍入后 |
| ---------- | ------ | ---------- | ------ |
| $s_0=1.33$ | → 1    | $s_1=3.08$ | → 3    |
| $s_2=4.55$ | → 5    | $s_3=5.67$ | → 6    |
| $s_4=6.23$ | → 6    | $s_5=6.65$ | → 7    |
| $s_6=6.86$ | → 7    | $s_7=7.00$ | → 7    |
| 综上所述： |        |            |        |

- $r_0 = 0 \rightarrow s_0 = 1$
- $r_1 = 1 \rightarrow s_1 = 3$
- $r_2 = 2 \rightarrow s_2 = 5$
- $r_3 = 3 \rightarrow s_3 = 6$
- $r_4 = 4 \rightarrow s_4 = 6$
- $r_5 = 5 \rightarrow s_5 = 7$
- $r_6 = 6 \rightarrow s_6 = 7$
- $r_7 = 7 \rightarrow s_7 = 7$

（看清这个图的细节画法，2025 考试要求从零画出来：）

![Pasted image 20250607162631](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250607162631.png)

#### 讨论

直方图均衡化的特点：

- 由于只是概率分布函数的近似，而且需要进行四舍五入（不允许产生新的灰度级），所以很少形成完美的直方图。
- 增强了原图的对比度。
- 自动计算，简单。

直方图均衡化前后对比：

![Pasted image 20250607163203](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250607163203.png)

横轴表示原来的灰度，纵轴表示均衡化之后对应的灰度。

### 直方图规定化（匹配）

直方图均衡化的变换目标：均匀分布
直方图规定化的变换目标：给定的分布

#### 原理

用均匀分布$s$ 做中间桥梁，$z$ 是目标分布（给定的参考图像），$r$ 是输入的要处理的分布：
$$
s = T(r) = (L-1) \int_0^r p_r(w) dw
$$

$$
s = G(z) = (L-1) \int_0^z p_z(t) dt
$$

因此有：
$$
G(z) = T(r)
$$

$$
z = G^{-1}[T(r)] = G^{-1}(s)
$$

#### 步骤

把两幅图像都先做直方图均衡，然后把目标分布的直方图均衡过程逆过来插在输入图像直方图均衡过程后面。无论是连续还是离散都是这样的。离散的情况如果逆过程映射不唯一就按惯例选择最小值即可。

1. 求 $p_r(r)$
2. 均衡化，求 $s$
3. 根据参考图像求 $G(z)$
4. 根据 $G(z)$ 求 $G^{-1}(z)$ 
5. $z = G^{-1}(s)$ ，也就是解方程 $G(z)=s$ 

#### 例题

连续灰度值的例子：

假设采用连续灰度值，并假设一幅图像的灰度值PDF为：

$p_r(r) = \frac{2r}{(L-1)^2}, \quad 0 \leq r \leq (L-1)$

对于其他 $r$ 值有 $p_r(r) = 0$。

寻找一个变换函数，使得产生的图像的灰度PDF是：

$p_z(z) = \frac{3z^2}{(L-1)^3}, \quad 0 \leq z \leq (L-1)$

而对于其他 $z$ 值有 $p_z(z) = 0$。

第一步：直方图均衡变换

首先，对区间 $[0, L-1]$ 寻找直方图均衡变换：

$s = T(r) = (L-1) \int_0^r p_r(w)dw = \frac{2}{(L-1)} \int_0^r w dw = \frac{r^2}{(L-1)}$

由定义可知，对于范围 $[0, L-1]$ 外的值，该变换为0。输入灰度值的平方除以 $(L-1)$ 将产生一幅灰度为 $s$ 并具有均匀PDF的图像，这部分是直方图均衡变换的内容。

根据您提供的图像，我将其中的文本内容提取并转换为 Markdown 格式：

第二步：规定直方图的变换

接下来的部分是关于具有规定直方图的图像。在 $[0, L-1]$ 区间寻找下一个直方图均衡变换：

$G(z) = (L-1) \int_0^z p_z(w)dw = \frac{3}{(L-1)^2} \int_0^z w^2 dw = \frac{z^3}{(L-1)^2}$

由定义可知在该区间外这个函数也为0。

第三步：求解逆变换

最后，要求 $G(z) = s$，因此：

$\frac{z^3}{(L-1)^2} = s$

并且有：

$z = [(L-1)^2 s]^{\frac{1}{3}}$

完整变换过程

将 $s = \frac{r^2}{(L-1)}$ 带入上式可得：

$z = [(L-1) r^2]^{\frac{1}{3}}$

如果用 $(L-1)^2$ 乘以直方图均衡过的每一个像素，取该乘积的 $\frac{1}{3}$ 次幂，结果将是一幅期望的图像，该图像在区间 $[0, L-1]$ 内 $z$ 的灰度的PDF为 $p_z(z) = \frac{3z^2}{(L-1)^3}$。

离散灰度级的例子：TODO

## 空间滤波

空间滤波器由(1)一个邻域(典型地是一个较小的矩形)，(2)对该邻域包围的图像像素执行的预定义操作组成。滤波产生一个新像素，新像素的坐标等于邻域中心的坐标，像素的值是滤波操作的结果。

当关注点在于卷积模板的响应特性 _R_ 时，可以写成向量形式：$R = w^T z$ 

### 平滑空间滤波

平滑滤波器用于模糊处理和降低噪声。

#### 平滑线性滤波器

输出(响应)是包含在滤波器模板邻域内的像素的**简单平均值**。这些滤波器也称为**均值滤波器**，可以把该类滤波器归入**低通滤波器**。

主要作用：降低噪声，去除图像中的比滤波器模板尺寸小的细节。

负面效应：边缘模糊；由于灰度级数量不足而引起的伪轮廓效应。

较小物体的灰度就与背景混合在一起， 较大物体变得像“斑点”而易于检测。模板的大小由那些即将融入背景中的物体尺寸来决定。

#### 统计排序（非线性）滤波器

以滤波器包围的图像区域中所包含的像素的排序(排队)为基础， 然后使用统计排序结果决定的值代替中心像素的值。

中值滤波器将像素邻域内灰度的中值(在中值计算中包括原像素值)代替该像素对应位置的值。中值滤波器对处理脉冲噪声非常有效，该种噪声也称为椒盐噪声。

![Pasted image 20250607171220](https://cdn.jsdelivr.net/gh/HungryFlo/test-foo/Pasted%20image%2020250607171220.png)

### 锐化空间滤波

下面介绍一种使用二阶微分进行图像锐化的各向同性（旋转不变）滤波器——拉普拉斯算子。

**最简单的各向同性微分算子是拉普拉斯算子。一个二维图像函数的拉普拉斯算子定义为**

$\nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2}$ (3.6-3)

**以离散形式描述这一公式，使用式(3.6-2)的定义。在x方向上，有**

$\frac{\partial^2 f}{\partial x^2} = f(x+1,y) + f(x-1,y) - 2f(x,y)$ (3.6-4)

**类似地，在y方向上，有**

$\frac{\partial^2 f}{\partial y^2} = f(x,y+1) + f(x,y-1) - 2f(x,y)$ (3.6-5)

**所以，遵循这三个公式，两个变量的离散拉普拉斯算子是**

$\nabla^2 f = f(x+1,y) + f(x-1,y) + f(x,y+1) + f(x,y-1) - 4f(x,y)$ (3.6-6)

**拉普拉斯算子的3×3卷积核：**

```
 0   1   0
 1  -4   1
 0   1   0
```

**使用拉普拉斯对图像增强的基本方法可表示为下式：**

$g(x,y) = f(x,y) + c[\nabla^2 f(x,y)]$ (3.6-7)

**其中，$f(x,y)$ 和 $g(x,y)$ 分别是输入图像和锐化后的图像。使用负中心常数的滤波器时 $c = -1$，否则 $c = 1$。**

四种不同的3×3拉普拉斯滤波器模板：

**1. 基本拉普拉斯滤波器：**

```
 0   1   0
 1  -4   1
 0   1   0
```

**2. 包含对角线的拉普拉斯滤波器：**

```
 1   1   1
 1  -8   1
 1   1   1
```

**3. 正中心常数滤波器：**

```
 0  -1   0
-1   4  -1
 0  -1   0
```

**4. 正中心常数对角线滤波器：**

```
-1  -1  -1
-1   8  -1
-1  -1  -1
```

这些滤波器用于图像锐化处理，通过强调图像中的边缘和细节来增强图像质量。选择哪种滤波器取决于具体的应用需求和所需的增强效果。

# 频率域滤波

## 基本概念

- **复数定义**: $z = R + jI$，其中 $j = \sqrt{-1}$
- **共轭复数**: $z^* = R - jI$
- **几何表示**: 复平面上的点，坐标为(R, I)
- **极坐标表示**: $z = |z|(\cos θ + j \sin θ)$
- **欧拉公式**: $e^{jθ} = \cos θ + j \sin θ$
- **复数的指数形式**: $z = |z|e^{jθ}$

## 傅里叶变换（应该不会考）

- **核心思想**: 任何周期函数都可以表示为不同频率的正弦或/和余弦之和
- **傅里叶级数公式**:
  $f(x) = a_0 + \sum_{n=1}^{\infty} [a_n\cos(\frac{2πnx}{T}) + b_n\sin(\frac{2πnx}{T})]$
- **指数形式**:
  $f(t) = \sum_{n=-\infty}^{\infty} c_n \cdot e^{j2πnt/T}$


- **频率域概念**: 从函数的频率角度分析函数，与时间域相对
- **连续傅里叶变换**:
  $F(μ) = \int_{-\infty}^{\infty} f(t)e^{-j2πμt}dt$
- **连续傅里叶反变换**:
  $f(t) = \int_{-\infty}^{\infty} F(μ)e^{j2πμt}dμ$

#### 二维傅里叶变换

- **二维傅里叶变换**:
  $F(u,v) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f(x,y)e^{-j2π(ux+vy)}dxdy$
- **二维傅里叶反变换**:
  $f(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} F(u,v)e^{j2π(ux+vy)}dudv$

#### 离散傅里叶变换(DFT)

- **一维DFT**:
  $F(u) = \sum_{x=0}^{M-1} f(x)e^{-j2πux/M}$
- **一维IDFT**:
  $f(x) = \frac{1}{M}\sum_{u=0}^{M-1} F(u)e^{j2πux/M}$
- **二维DFT**:
  $F(u,v) = \sum_{x=0}^{M-1}\sum_{y=0}^{N-1} f(x,y)e^{-j2π(ux/M+vy/N)}$
- **二维IDFT**:
  $f(x,y) = \frac{1}{MN}\sum_{u=0}^{M-1}\sum_{v=0}^{N-1} F(u,v)e^{j2π(ux/M+vy/N)}$

### 二维离散傅里叶变换的性质（2025 大题）

#### 平移性质

- $f(x,y)e^{j2π(u_0x/M+v_0y/N)} ⇔ F(u-u_0, v-v_0)$
- $f(x-x_0, y-y_0) ⇔ F(u,v)e^{-j2π(ux_0/M+vy_0/N)}$
- **中心化**: 当 $u_0=M/2, v_0=N/2$ 时，$f(x,y)(-1)^{x+y} ⇔ F(u-M/2, v-N/2)$

空间域平移，频率域**幅度**不变，**相位**发生线性变化。

#### 尺度变换（缩放）

- $af(x,y) ⇔ aF(u,v)$
- $f(ax,by) ⇔ \frac{1}{|ab|}F(u/a, v/b)$

#### 旋转性

- $f(r, θ+θ_0) ⇔ F(ρ, φ+θ_0)$

#### 周期性

- $F(u,v) = F(u+k_1M, v) = F(u, v+k_2N) = F(u+k_1M, v+k_2N)$

#### 平均值

- $F(0,0) = \sum_{x=0}^{M-1}\sum_{y=0}^{N-1} f(x,y)$
- 变化最慢的频率分量(0,0)正比于图像的平均灰度

#### 卷积定理

- $f(x,y) * h(x,y) ⇔ F(u,v)H(u,v)$
- $f(x,y)h(x,y) ⇔ F(u,v) * H(u,v)$

## 频率域滤波

### 频率域滤波基础

#### 基本原理

- **滤波公式**: $g(x,y) = \mathcal{F}^{-1}\{H(u,v)F(u,v)\}$
- **频率与图像特征的关系**:
  - 低频分量：图像中变化缓慢的灰度分量
  - 高频分量：图像中快速的灰度变化（边缘、细节）

#### 频率域滤波步骤

1. 对输入图像f(x,y)进行零填充，得到fp(x,y)
2. 用(-1)^{x+y}乘以fp(x,y)进行中心化
3. 计算DFT得到F(u,v)
4. 生成滤波函数H(u,v)，计算G(u,v) = H(u,v)F(u,v)
5. 计算IDFT得到gp(x,y)
6. 用(-1)^{x+y}乘以gp(x,y)的实部
7. 从左上角提取M×N区域得到最终结果g(x,y)

### 图像平滑（低通滤波）

#### 理想低通滤波器(ILPF)（这几个英文缩写要记住，2025 大题）

- **传递函数**:
  $H(u,v) = \begin{cases} 1 & \text{if } D(u,v) \leq D_0 \\ 0 & \text{if } D(u,v) > D_0 \end{cases}$
- **距离公式**: $D(u,v) = \sqrt{(u-P/2)^2 + (v-Q/2)^2}$
- **特点**: 存在明显的振铃现象

#### 布特沃斯低通滤波器(BLPF)

- **传递函数**:
  $H(u,v) = \frac{1}{1 + [D(u,v)/D_0]^{2n}}$
- **特点**: 
  - 低频和高频之间平滑过渡
  - 二阶BLPF振铃现象通常很难察觉（但是一阶的已经比理想的振铃不明显了）。
  - 是有效低通滤波和可接受振铃特性的折中

#### 高斯低通滤波器(GLPF)

- **传递函数**:
  $H(u,v) = e^{-D^2(u,v)/2D_0^2}$
- **特点**: 
  - 无振铃现象
  - 在医学图像等应用中很重要
  - 相同截止频率下平滑效果比BLPF稍差

### 图像锐化（高通滤波）

#### 高通滤波器与低通滤波器的关系

- $H_{HP}(u,v) = 1 - H_{LP}(u,v)$

#### 理想高通滤波器(IHPF)

- **传递函数**:
  $H(u,v) = \begin{cases} 0 & \text{if } D(u,v) \leq D_0 \\ 1 & \text{if } D(u,v) > D_0 \end{cases}$

#### 布特沃斯高通滤波器(BHPF)

- **传递函数**:
  $H(u,v) = \frac{1}{1 + [D_0/D(u,v)]^{2n}}$

#### 高斯高通滤波器(GHPF)

- **传递函数**:
  $H(u,v) = 1 - e^{-D^2(u,v)/2D_0^2}$

#### 频率域拉普拉斯算子

- **传递函数**: $H(u,v) = -4π^2D^2(u,v)$
- **拉普拉斯图像**: $∇^2f(x,y) = \mathcal{F}^{-1}\{H(u,v)F(u,v)\}$
- **增强实现**: $g(x,y) = f(x,y) + c∇^2f(x,y)$
- **频率域表示**: $g(x,y) = \mathcal{F}^{-1}\{[1 + 4π^2D^2(u,v)]F(u,v)\}$

## 重要概念总结

### 关键术语

- **带限函数**: 在有限频率范围外傅里叶变换为零的函数
- **取样定理**: 取样率必须超过函数最高频率的两倍
- **奈奎斯特取样率**: 等于最高频率两倍的取样率
- **截止频率D₀**: 滤波器的分界频率
- **振铃现象**: 理想滤波器造成的空间域振荡效应

### 滤波器特性对比

| 滤波器类型     | 优点               | 缺点           | 适用场合               |
| -------------- | ------------------ | -------------- | ---------------------- |
| 理想滤波器     | 频率响应明确       | 严重振铃现象   | 理论分析               |
| 布特沃斯滤波器 | 平滑过渡，振铃较少 | 计算复杂度中等 | 一般图像处理           |
| 高斯滤波器     | 无振铃现象         | 过渡较缓       | 医学图像等要求高的场合 |

# 彩色图像处理

彩色图像处理的两个领域：

- 全彩色图像处理：图像需由全彩色传感器获得
- 伪彩色图像处理：对一种特定的单色灰度或灰度范围赋予一种颜色

## 彩色的描述

描述彩色光源质量的三个基本量：

- 辐射：从光源流出的能量总量（瓦）（包括所有波段）。
- 光强：观察者从光源感知的能量总量（流明）（只算可见光的部分）。
- 亮度：主观。灰度级提供了一个标量度量。

### 彩色模型（2025 大题：缩写、全称、特点、应用）

光的三原色：RGB
颜料三原色（光的二次色）：CMY(Cyan青=蓝绿, Magenta洋红=蓝红, Yellow黄=红绿)

彩色模型：

- RGB（各 8bit，共 24bit）（256 种颜色，216 种稳定色）
- CMY(blacK)：归一化到 $[0,1]$ 之后 $[ C M Y] = [1 1 1] - [R G B]$
- HSI（Hue色调、Saturation饱和度、Intensity亮度（强度））

关于 HSI 的详细内容：
亮度
**定义**: 表达了无色的强度概念。

色调
**定义**: 光波混合中与主波长有关的属性，用角度度量。
**例子**: 描述一个物体为红色、橙色或黄色时，指的是色调，表示观察者感知的主要颜色。

饱和度
**定义**: 指的是相对纯净度，或一种颜色混合白光的数量。
**特点**: 

- 饱和度与所加白光的数量成反比
- 饱和度高，颜色则深而艳
  **例子**: 
- 纯谱色是全饱和的
- 粉色（红+白）、薰衣草色（紫+白）是欠饱和的

色度：
**定义**: 色调与饱和度一起称为色度。
**总结**: 颜色可用其亮度和色度来表征。

RGB 模型 → HSI 模型
色调 (H - Hue)
$$
H = \begin{cases} 
\theta & \text{if } B \leq G \\
360 - \theta & \text{if } B > G
\end{cases}
$$

其中：
$\theta = \cos^{-1}\left\{\frac{\frac{1}{2}[(R-G) + (R-B)]}{[(R-G)^2 + (R-B)(G-B)]^{1/2}}\right\}$

饱和度 (S - Saturation)
$S = 1 - \frac{3}{(R + G + B)}[\min(R, G, B)]$

亮度 (I - Intensity)
$I = \frac{1}{3}(R + G + B)$

说明
RGB 值和 HSI 分量均归一化到 $[0,1]$ (H分量除以360°)

## 全彩色图像处理

两种大思路：分别处理各个分量再求和；直接 3 个分量一起处理
两种思路若要等同，必须要满足两个条件：

- 处理必须对向量和标量都可用；（照顾一下 HSI）
- 对向量的每个分量的操作对于其他分量必须是独立的。

### 降低亮度

假设想要改变全彩色图像的强度：$g(x,y) = kf(x,y), (0 < k < 1)$

RGB 彩色空间：3个分量都必须变换：$s_i = kr_i, \quad i = 1,2,3$

CMY 彩色空间：$s_i = kr_i + (1-k), \quad i = 1,2,3$

HSI 彩色空间：$s_1 = r_1, \quad s_2 = r_2, \quad s_3 = kr_3$

这表明HSI彩色空间在进行强度调整时具有明显的优势，因为它将颜色信息与强度信息分离，使得强度调整更加直观和简单。

### 补色

在彩色环上，与色调直接相对的另一端被称为补色。

### 彩色分层

把感兴趣色彩区域（球体或立方体）之外的颜色强制映射到一个“平庸”的颜色（比如0.5）上。

### 色调色彩校正

类似于灰度变换（线性、对数、幂次）

### 平滑和锐化

RGB模型处理特点：

- 直接对红、绿、蓝三个颜色分量分别进行平滑
- 会同时影响颜色和亮度信息
- 可能导致颜色失真

HSI模型处理优势：

- **H (Hue 色调)**：颜色的基本属性
- **S (Saturation 饱和度)**：颜色的纯度
- **I (Intensity 亮度)**：颜色的明暗程度

**HSI彩色模型的重要优点**：

- ✅ **解除了强度和彩色信息的关联**
- ✅ 只处理亮度分量，保持色彩信息不变
- ✅ 更适合各种灰度处理算法的应用
- ✅ 处理结果更自然，避免颜色失真

两种方法的处理结果存在明显差异，特别是在：

- 颜色过渡区域
- 高对比度边缘
- **随着模板尺度增大，差异会变得更加显著**

## 伪彩色图像

对任何输入像素的灰度执行 3 个独立的变换，分别对应红、绿、蓝通道，产生一幅合成图像，合成图像的彩色内容由变换函数的特性调制。

# 图像压缩

三种基本的数据冗余（2025 大题）：

- 编码冗余
- 空间和时间冗余
- 不相关信息

压缩率：
$$
C = b / b^{\prime}
$$

相对数据冗余：
$$
R = 1 - 1 / C = 1 - b^{\prime} / b = (b-b^{\prime})/b
$$

## 编码冗余

先定义一下每个像素所需的平均比特数：
$$
L_{avg} = \sum_{k=0}^{L-1} l(r_k) p_r(r_k)
$$
本质就是对每一个灰度级的所需位数加权（该灰度级的出现概率）平均。

编码冗余产生原因：直方图不均匀（每个灰度级的出现概率不同）

### 定长编码：自然m比特固定长度编码

基本概念：

1. **固定长度**：所有编码后的二进制串都具有相同的长度(m比特)
2. **自然编码**：通常指直接使用数值的二进制表示形式
3. **编码范围**：可以表示2^m个不同的值(从0到2^m-1)

特点：

- **简单易实现**：编码解码过程非常直接
- **空间效率**：对于均匀分布的数据效率高，但对于非均匀分布可能浪费空间
- **无前缀特性**：由于长度固定，不需要前缀码来区分不同编码
- **不支持扩展**：一旦确定m值，就无法表示超过2^m个不同的符号

### 变长编码

#### 霍夫曼编码

霍夫曼编码是一种利用信息符号概率分布特性的可变字长的编码方法。对于出现概率大的信息符号编以短字长的码，对于出现概率小的信息符号编以长字长的码。
是一种瞬时、唯一可解码的块编码。

霍夫曼编码存在的问题：

- 当对大量符号进行编码，构造霍夫曼编码比较复杂
- 对 J 个信源符号，需要进行 J-2 次信源化简和 J-2 次编码分配

***要会做霍夫曼编码解码，并计算平均长度和信源熵。***

#### Golomb 编码

Golomb 编码针对非负整数进行编码。

符号表中的符号出现的概率符合几何分布时，可以取得最优效果，也就是说 Golomb 编码比较适合小的数字比大的数字出现概率高的编码（例如视频前后帧之间的差）。

使用较短的码长编码较小的数字，较长的码长编码较大的数字。

> 一元编码 Unary coding
> 对于任意非负整数 n，它的一元编码就是 n 个 1 后面紧跟着一个 0。 （4 -> 11110）

分组编码：
待编码的非负整数 $n$，给定的正整数参数 $m$，$n$ 关于 $m$ 的哥伦布编码为下面两部分的组合：

- $\lfloor n/m \rfloor$ 的一元编码
- $n \mod m$ 的二进制表示

$G_m(n)$ 的构建步骤：

步骤 1：形成商  $\lfloor n/m \rfloor$ 的一元编码；

步骤 2：令  $k = \lceil log_2 m \rceil$，也就是二进制表示 $m$ 所需要的位数，  $c = 2^k - m$，也就是这个位数下多分配的表示能力， $r = n \mod m$，并计算截短的余数  $r'$，例如，使其满足
$$
r' = 
\begin{cases} 
r \text{ 截短至 } k-1 \text{ 比特}, & 0 \leq r < c \\
r + c \text{ 截短至 } k \text{ 比特}, & \text{其他}
\end{cases}
$$

步骤 3：连接步骤 1 和步骤 2 的结果。

#### 算术编码（2025 大题）

人话说就是：先把 0 到 1 按照字符出现概率比例进行切分，然后把待编码串中第一个字符对应的区间作为整个区间再次进行切分，接着把前两个字符确定的区间拿来做切分，……直到最后获得一个小数的区间，然后取这个区间里位数最短的二进制小数的小数部分作为整个串的编码。

## 空间冗余（图像内相关 intra-picture correlation）

一幅图像表面上各采样点的颜色之间往往存在着空间连贯性，这些颜色相同的块就可以压缩。

### 行程长度编码(Run Length Encoding, RLE)

具有相同颜色且是连续的像素数目称为行程长度。

比如，256 个 100 像素值可以表示成 $[256, 100]$

### LZW 编码

人话说就是：设计了一个严密的程序化逻辑（意味着你记住就行），可以把没见过的串直接存在字典里面，（下一次见到的时候就能直接用字典的key来表示这个value，)同时还能正常输出编码结果。

看一下就会了：
【《蜉蝣学长》考研830数字图像处理…图像压缩字典编码（lzw编码）·电子科技大学生物医学工程考研】 https://www.bilibili.com/video/BV1x14y1e7D4/?share_source=copy_web&vd_source=b2c0ef38609e73c96262cb57d9e244dd

## 时间冗余（图像间相关 inter-picture correlation）

序列图像中相邻帧之间具备一定的相似性。

### 图像间作差

将差异信号发送到接收端，接收器则可以利用差异信号和已经接收到的参考帧重建视频帧。

## 不相关信息（视觉冗余）

人类视觉系统对图像场的敏感性是非均匀和非线性的。在记录原始的图像数据时，通常假定视觉系统是线性的和均匀的，视觉敏感和不敏感的部分同等对待，从而产生了比理想编码更多的数据。

### 量化

将较宽范围的输入值映射为有限数量的输出值。（有损压缩，不可逆）

## 无损图像压缩的极限——信息的视角

### 信息量

随机事件 $E$ ，概率 $P(E)$，包含信息 $I(E)$ ，则：
$$
I(E) = -\log P(E)
$$
通常根据对数的底 $m$ 定义信息量的量纲。
$m=2$, bit
$m=e$, nat
$m=10$, hart

### 信源的熵

可以理解成独立随机事件的集合中每个可能事件的信息量的加权平均。

$$
H = - \sum_{j=1}^{J} P(a_j)\log P(a_j)
$$

将图像考虑为一个虚构的零记忆 “灰度信源”的输出，通过观察图像的直方图估计该信源的符号 $a_j$ 概率，此时，灰度信源的熵（以 bit 度量的虚构灰度信源的每个灰度输出的平均信息）为：
$$
\tilde{H} = -\sum_{k=0}^{L-1} P_r(r_k) \log_2 P_r(r_k)
$$

用少于 $\tilde{H}$ bit/pixel 的熵对虚构信源的灰度值进行编码是不可行的。

### 香农第一定理

香农第一定理，也称为**无噪声编码定理**（Noiseless Coding Theorem）或**可变长度编码定理**，是信息论中的核心定理之一，由**克劳德·香农（Claude Shannon）** 于1948年在其开创性论文《通信的数学理论》中提出。该定理给出了**无损数据压缩**的理论极限。

香农第一定理指出：
对于离散无记忆信源（DMS, Discrete Memoryless Source），其熵为  $H$ ，则存在一种编码方式，使得平均码长  $L$  满足：
$$
H \leq L < H + \epsilon
$$
其中， $\epsilon$  是一个可以任意小的正数。

换句话说：

- 最优编码的平均码长不可能低于信源的熵  $H$ 。
- 通过合适的编码（如霍夫曼编码、算术编码等），可以无限接近熵  $H$ ，但不会低于它。

香农第一定理表明：

- 如果符号概率分布不均匀，采用变长编码（如霍夫曼编码）可以比固定长度编码更高效。
- 如果所有符号等概率分布，固定长度编码已经最优（此时  $H = \log_2 M$ ，其中  $M$  是符号数）。

## 保真度准则：对有损压缩信息损失的量化

### 客观保真度准则

先压缩再解压缩，然后和原图对比：

- 均方根误差($e_{rms}$)：逐项平方，最后开根
- 均方信噪比($SNR_{ms}$)：还原图像的平方（信息）除以误差的平方（噪声）

### 主观保真度准则

客观保真度完全一样的两幅图像可能会有完全不同的视觉质量，所以又规定了主观保真度准则。

## 压缩模型

编码器：映射器（时间空间冗余）、量化器（不相关信息）、符号编码器（编码冗余）
解码器：符号解码器、逆映射器（量化是不可逆的）

## 压缩编码

第一代压缩编码：去除线性相关性，主要包括预测编码（动态、有损或无损）、变换编码（静态、有损）、统计编码（静态、无损）三种。

> 统计编码包括霍夫曼编码、算术编码、行程编码、Golomb编码、LZW编码等。

第二代压缩编码：不局限于信息论的框架，要求充分利用人的视觉生理心理和图像信源的各种特征。包括子带编码、基于方向性分解的编码、基于区域分割与合并的编码。

# 形态学图像处理

这一章考了很多，所以一定要好好复习。

既要能够画图操作基本的运算，还需要理解和分辨一些算法的步骤或者是定义式。

## 预备知识

集合的反射：集合中所有的元素取相反数。

集合的平移：集合中所有的元素都加同一个数。

结构元（Structuring Element, SE）：研究图像中感兴趣的特性所使用的小集合或子图像。结构元必须在几何上比原图像简单，且有界。

对图像进行操作时，要求结构元是矩形阵列，可以通过添加背景块把非矩形集合补成矩形。

## 腐蚀

B 对 A 的腐蚀：B 通过 z 平移后，仍然包含在 A 中所有 B 的中心点的集合。

通俗的讲：把 B 在 A 上贴着边移动，B 的中心点画出来的框内部就是腐蚀的结果。

腐蚀可以消除二值图像中的不相关细节。

## 膨胀

B 对 A 的膨胀：把 B 结构元关于原点进行反射，然后贴着 A 的边绕一圈，B 结构元的原点的轨迹围成的图形就是膨胀的结果。

膨胀可以桥接断裂文本的间隙。

腐蚀与膨胀彼此关于集合的求补和反射运算对偶。

## 开运算

先腐蚀后膨胀。当 $B$ 在 $A$ 的边界**内侧**滚动时，𝐵所能到达边界的最远点。

## 闭运算

先膨胀后腐蚀。当 $B$ 在 $A$ 的边界**外侧**滚动时，𝐵所能到达边界的最远点。

闭运算的作用：

1. 弥合较窄的间断和细长的沟壑；
2. 消除小的孔洞；
3. 填补轮廓线中的断裂。

指纹噪声消除：
先开运算：消除噪声，但是指纹被截断；
再闭运算：使指纹再次连接起来。

## 击中-击不中变换 (Hit-or-Miss Transformation, HMT)

形态学形状检测基本工具。

使用两个结构元， $B_1, B_2$，最终的结果为：前景被 $B_1$ 腐蚀的结果与背景被 $B_2$ 的腐蚀结果的交集。

最后的结果只有与结构元形状完全一致的图形的原点位置。

## 基本形态学算法

### 边界抽取

先腐蚀一圈再用原图作差

### 区域填充

膨胀、取补、交集

### 连通分量提取



# 图像分割

2025 年的考点：

填空题：

对于一阶导数的任何近似的要求：

- 在恒定灰度区域必须**为零**
- 在灰度台阶或斜坡开始处必须**不为零**
- 在沿灰度斜坡点处也必须**不为零**

对于二阶导数的任何近似的要求：

- 在恒定灰度区域必须为零
- 在灰度台阶或斜坡的开始处和结束处必须不为零
- 在沿灰度斜坡必须为零

选择题：

线检测的模板（拉普拉斯检测子）

基于固定阈值的分割的前提条件：图像直方图上出现双峰现象，即目标区域与背景区域的灰度差异较大。

大题：

基于区域的分割（区域生长画图题）

# 计算机视觉

## 基本的机器学习知识

考点：
梯度下降算法
反向传播计算图

## 卷积神经网络（必考 大题）

卷积层和池化层尺寸计算（背或者推那个公式）

$$
m = \frac{n+2p-k}{s} +1
$$

卷积层参数量计算（不要忘记通道数和 bias ）：

$$
n' = (k \times k \times c_{in} + 1) \times c_{out}
$$

全连接层的参数计算

